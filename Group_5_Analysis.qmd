---
title: "Group_5_Analysis"
number-sections: true
format: 
  html:
    embed-resources: true
    code-tools: true
  pdf: default
editor_options: 
  chunk_output_type: console
---

```{r}
#| echo: false
#| warning: false
#| message: false

library(dplyr)
library(ggplot2)
library(tidyverse)
library(gt)
library(MASS)
library(patchwork)
library(gapminder)
library(janitor)
library(tidymodels)
library(moderndive)
library(ggstats)
```

# Introduction {#sec-intro}

```{r}
#| echo: false

# Read in the data
Project11 <- read.csv("~/Desktop/STATS4052/DAS-Group-5/DAProject11.csv")

# Add a new column called IsObese based on the value of BMI group
Project11 <- Project11 |>
  dplyr::mutate(IsObese = ifelse(BMIgroup == "Obese", "Obesity", "Not Obesity"))

Project11$Year <- as.factor(Project11$Year)
```

# Exploratory Analysis {#sec-exp}

```{r}
#| echo: false
#| label: tbl-proportion
#| tbl-cap: "Proportion of obseity by year"

Project11 |>
  tabyl(Year,IsObese) |>
  adorn_percentages() |>
  adorn_pct_formatting() |>
  adorn_ns() |>
  gt()
```

```{r}
#| echo: false
#| label: fig-barplot
#| message: false
#| fig-cap: "Barplot of year by Obesity"
#| fig-width: 4
#| fig-height: 3
#| fig-align: center

ggplot(data = Project11, aes(x = IsObese, group = Year))+
  geom_bar(aes(y = after_stat(prop), fill = Year), stat = "count", position = "dodge") +
  labs(y = "Proportion", fill = "Year")
```

# Formal Analysis {#sec-formal}

We fit the logistic regression model,

```{r}
#| echo: false
#| tbl-cap: "Estimates of the intercept and slope from the fitted logistic regression model"
#| label: tbl-estimates

Project11 <- Project11 |>
  dplyr::mutate(IsObese = ifelse(BMIgroup == "Obese", 1, 0))

model <- glm(IsObese ~ Year, data = Project11,
                     family = binomial(link = "logit")) 
Coefs <- round(coef(model), 3)
tidy(model)[,c(1,2,3,5)] |>
  gt() |>
  fmt_number(decimals=4)
```

baseline: Year 2013

# Conclusion {#sec-con}
